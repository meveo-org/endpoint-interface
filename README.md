# endpoint-interface

These are sample javascript modules that shows how auto-generated or manually created interfaces to rest endpoints should be created.

Basically the interface exposes the following functions:

```javascript
export const getRequestSchema = async (parameters, config) => {
  /*
  this schema can either be generated by meveo endpoint directly
  or could be a call to another API that returns the schema
  (in case it is another API call, parameters and config are included in the function call)
  if there are no request parameters, just return null
  this is a sample schema:
  */
  return {
    name: "UserProfileRequest",
    description: "The parameters used in invoking a user profile request",
    properties: {
      userId: {
        type: "STRING",
        required: true,
        description: "The id of the User."
      }
    }
  };
};

export const getResponseSchema = async (parameters, config) => {
  /*
  this schema can either be generated by meveo endpoint directly
  or could be a call to another API that returns the schema
  (in case it is another API call, parameters and config are included in the function call)
  in this example, we will just return a hard coded schema
  if there are no request parameters, just return null
  */
  return {
    name: "UserProfileResponse",
    description: "Schema definition for a user profile",
    properties: {
      userName: {
        type: "STRING",
        required: true,
        description: "The name of the user."
      },
      attributes: {
        type: "OBJECT",
        required: false,
        description: "Additional user profile information",
        properties: {
          locale: {
            type: "ARRAY",
            "item-type": "STRING",
            required: true,
            description: "Locales registered to the user."
          }
        }
      }
    }
  };
};

export const executeApiCall = async (
  component,
  params,
  successCallback /*optional*/,
  errorCallback /*optional*/
) => {
  try {
    // retrieve data from API
    component.dispatchEvent(
      new CustomEvent(EVENT.SUCCESS, { detail: { result }, bubbles: true })
    );
  } catch (error) {
    component.dispatchEvent(
      new CustomEvent(EVENT.ERROR, { detail: { error }, bubbles: true })
    );
  }
};
```

The example code (`GetKeycloakUserProfile.js`, `UpdateKeycloakUserProfile.js`) above contains sample implementation for retrieving a keycloak user's profile and updating it. In the client application, they can be used as such:

```javascript
import * as GetKeycloakUserProfile from "GetKeycloakUserProfile.js";

const userProfile = GetKeycloakUserProfile.executeApiCall(
  this,
  parameters,
  this.handleSuccess,
  this.handleError
);

handleSuccess = event => {
  const {
    detail: { result }
  } = event;
  console.log("result: ", result);
};

handleError = event => {
  const {
    detail: { error }
  } = event;
  console.log("error: ", error);
};
```
